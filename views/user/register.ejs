<!DOCTYPE html>
<html lang="en">

<head>
  <%- include('../partials/head') %>
    <link rel="stylesheet" href="/css/index.css">
    <link rel="stylesheet" href="/css/form-head.css">
    <link rel="stylesheet" href="/css/form.css">
</head>

<body>
  <main>
    <section id="head">
      <a href="/">
        <img src="/images/fav.png">
        <span>Koshigo</span>
      </a>
    </section>
    <section id="form">
      <div class="box">
        <form action="/signup" method="POST" class="left" enctype="multipart/form-data">
          <h1>Create Account</h1>
          <label>Profile Picture</label>
          <div class="file">
            <span>Change</span>
            <img>
            <svg viewBox="0 0 640 512">
              <path
                d="M537.6 226.6c4.1-10.7 6.4-22.4 6.4-34.6 0-53-43-96-96-96-19.7 0-38.1 6-53.3 16.2C367 64.2 315.3 32 256 32c-88.4 0-160 71.6-160 160 0 2.7.1 5.4.2 8.1C40.2 219.8 0 273.2 0 336c0 79.5 64.5 144 144 144h368c70.7 0 128-57.3 128-128 0-61.9-44-113.6-102.4-125.4zM393.4 288H328v112c0 8.8-7.2 16-16 16h-48c-8.8 0-16-7.2-16-16V288h-65.4c-14.3 0-21.4-17.2-11.3-27.3l105.4-105.4c6.2-6.2 16.4-6.2 22.6 0l105.4 105.4c10.1 10.1 2.9 27.3-11.3 27.3z" />
            </svg>
            <input type="file" name="photo">
          </div>
          <label for="">Your name</label>
          <input type="text" name="username" required>
          <label for="">Mobile number</label>
          <input type="tel" name="phone" required placeholder="Mobile number">
          <label for="">Email</label>
          <input type="email" name="email" required>
          <label for="">Password</label>
          <input type="password" name="password" required placeholder="At least 6 characters">
          <div class="info">Passwords must be at least 6 characters.</div>
          <button type="submit">Continue</button>
          <p>Already have an account? <a href="/login">Sign in</a></p>
        </form>
        <div class="right"></div>
      </div>
    </section>
  </main>

  <script>
    const fileWrapper = document.querySelector("#form > div > form > div.file")
    const profilePictureInput = document.querySelector("#form > div > form > div.file > input[type=file]")
    const profileImg = document.querySelector("#form > div > form > div.file > img")
    let regExp = /[0-9a-zA-Z\^\&\'\@\{\}\[\]\,\$\=\!\-\#\(\)\.\%\+\~\_ ]+$/

    fileWrapper?.addEventListener('click', function () {
      profilePictureInput.click()
    })

    profilePictureInput?.addEventListener('change', function () {
      const file = this.files[0]
      if (file) {
        const reader = new FileReader()
        reader.onload = function () {
          const result = reader.result
          profileImg.setAttribute('src', result)
          fileWrapper.classList.add('data')
        }
        reader.readAsDataURL(file)
      }
      if (this.value) {
        let fileName = this.value.match(regExp)
        // alert(fileName)
      }
    })
  </script>
</body>

</html>